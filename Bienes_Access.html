<!doctype html>
<html>
<head>
    <style>
    </style>
    
    <title>BN - Datos de Access</title>
    
    <script>
		function accede(accion,url,fn) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open(accion, url, true);
            xobj.onreadystatechange = function () {
                // console.log("State:",xobj.readyState,"Status:", xobj.status)
                if (xobj.readyState == 4 && xobj.status == "200") {
                    // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                    fn(JSON.parse(xobj.responseText));
                }
            };
            xobj.send(null);
        }
        
        function leeOfc(idOfc,mstOfc) {
			let codigo = idOfc || document.getElementById("idOfc").value
			
			accede("GET", "http://localhost:3000/oficina/" & idOfc,mstOfc)
		}
		
		function mstOfc(Bienes) {
			mstTabla(Bienes,"lstBienes","Oficina No. " +idOfc)
		}
		
		function mstTabla(datos,dom,caption = "") {
			let donde = typeof dom === "string" ? document.getElementById(dom) : dom;
			
			let tabla = "<table><caption>" +caption+ "</caption>";
			let titulos;
			datos.forEach(e => {
				if (!titulos) {
					titulos = "<thead><tr>";
					for (x in e) {
						titulos += "<th>"+x+"</th>";
					}
					titulos += "</tr></thead>";
					tabla += titulos+"<tbody>"; 
				}
				tabla +="<tr>";
				for (x in person) {
					tabla += "<td>" +e[x] +"</td>";
				}
				tabla +="</tr>";				
			}
			tabla += "</tbody></table>";
			
			donde.innerHTML = tabla;
		}
    </script>
</head>

<body>
  <h1>Bienes por Oficina</h1>
  <div>
		<form action="leeOfc()"
		  <label for="idOfc">Oficina</label>
		  <input type="text" id="idOfc" required/>
		  <input type="submit" value="Lee Oficina"/>
		</form>
  </div>
  <div id="lstBienes">
  </div>
  
  <footer>Elaborado por <a href="https://rafagomez.neocities.org">Rafa GÃ³mez</a></footer>
</body>
</html>
